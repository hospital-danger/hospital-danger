// Generated by CoffeeScript 1.6.1
(function(){var e,t,n,r,i;(r=this.console)==null&&(this.console={});(i=(n=this.console).log)==null&&(n.log=function(){});t=Popcorn.util.toSeconds;e=function(e){var t,n;t=Math.floor(e/60);n=e%60;t=t>9?""+t:"0"+t;n=n>9?""+n:"0"+n;return""+t+":"+n};$(function(){var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b;u=Popcorn("#the-video");r=$(".button-play");i=$(".time-bar");n=$(".buffer_bar");o=$(".time-left");s=$(".time-elapsed");d=0;p=0;a=0;h=[{type:"chapter",title:"A Safe Place",target:"#safety",time:"00:19"},{type:"chapter",title:"Quality of Care",target:"#quality-of-care",time:"00:42"},{type:"chapter",title:"Deceptively Simple",target:"#infection",time:"01:09"},{type:"chapter",title:"Deny & Defend",target:"#culpability",time:"01:34"},{type:"chapter",title:"Malpractice in Practice",target:"#malpractice-in-practice",time:"01:59"},{type:"chapter_end",time:"02:17",target:"#malpractice-in-practice-followup"},{type:"chapter",title:"Is It Getting Better?",target:"#no-improvement",time:"02:17"}];f=function(){var e,t,n;n=[];for(e=0,t=h.length;e<t;e++){c=h[e];c.type==="chapter"&&n.push(c)}return n}();l=function(){var e,t,n;n=[];for(e=0,t=h.length;e<t;e++){c=h[e];c.type==="citation"&&n.push(c)}return n}();for(y=0,b=f.length;y<b;y++){c=f[y];$("ul",".chapter-list").append("<li><a href='"+c.target+"'>"+c.title+"</a></li>")}g=function(){r.hasClass("paused")?u.play():u.pause();return r.toggleClass("paused")};r.add("#the-video").on("click",g);$(".progress").on("click",function(e){var t;t=e.offsetX/$(this).width();return u.currentTime(t*d)});v=function(e){var n,i,s,o,f;for(i=s=0,o=h.length;s<o;i=++s){c=h[i];c.target===e&&(f=[i,t(c.time)],a=f[0],n=f[1])}n!=null&&u.currentTime(n).play();return r.removeClass("paused")};$("a",".chapter-list").on("click",function(e){e.preventDefault();return v($(this).attr("href"))});$(document).on("keydown",function(e){var t,n,r,i,s;i=32;t=37;r=39;if(e.keyCode!==i)if(e.keyCode===t){e.preventDefault();n=Math.max(0,a-1)}else if(e.keyCode===r){e.preventDefault();n=Math.min(f.length-1,a+1)}if(n)return v((s=f[n])!=null?s.target:void 0)});$.each(h,function(e,n){return u.cue(t(n.time),function(){switch(n.type){case"citation":return $(".citations").html("<a href='"+n.target+"' target='_blank'>"+n.title+"</a>");case"chapter":return $(".chapter-title").show().text(n.title).delay(3e3).fadeOut(2e3);case"chapter_end":$(n.target).addClass("current");u.pause();return r.addClass("paused")}})});(function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m;e=$("#bacteria");t=e.parent();e.attr("width",t.width()).attr("height",t.height());n=e[0];s=n.getContext("2d");f=e.width()/4;u=e.height()/4;r=[];for(l=h=0;0<=f?h<=f:h>=f;l=0<=f?++h:--h){r[l]=[];for(c=p=0;0<=u?p<=u:p>=u;c=0<=u?++p:--p)r[l][c]=!1}m=[[1,0],[2,1],[0,2],[1,2],[2,2],[4,0]];for(d=0,v=m.length;d<v;d++){i=m[d];r[i[0]+10][i[1]+10]=!0}a=function(e,t){var n,i,s,o,a,l,c,h,p;n=0;h=[e-1,e,e+1];for(l=0,o=h.length;l<o;l++){i=h[l];p=[t-1,t,t+1];for(c=0,a=p.length;c<a;c++){s=p[c];-1<i&&i<f&&-1<s&&s<u&&r[i][s]&&[i,s]!==[e,t]&&(n+=1)}}return n};return o=function(){var e,t,n;e=[];for(l=t=0;0<=f?t<=f:t>=f;l=0<=f?++t:--t){e[l]=[];for(c=n=0;0<=u?n<=u:n>=u;c=0<=u?++n:--n)switch(a(l,c)){case 2:case 4:e[l][c]=r[l][c];break;case 3:e[l][c]=!0;r[l][c]||s.fillRect(l*4,c*4,4,4);break;default:e[l][c]=!1;r[l][c]&&s.clearRect(l*4,c*4,4,4)}}r=e;return setTimeout(o,100)}})();$("a",".decision-tree").on("click",function(e){var t;e.preventDefault();t=$(this).attr("href");return $(".decision-tree").scrollTo(t,1e3)});return(m=function(){p=u.currentTime();d=u.duration()||0;i.css({left:""+p/d*100+"%"});s.text(e(Math.floor(p)));o.text(e(Math.floor(d-p)));return setTimeout(m,200)})()})}).call(this);